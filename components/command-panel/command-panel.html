<div id="right-panel" class="flex-grow-1 h-100 d-flex flex-column bg-body overflow-hidden" style="min-width: 0;">
  <div class="p-3 border-bottom shadow-sm d-flex justify-content-between align-items-center bg-body-tertiary">
    <h5 class="mb-0"><i class="bi bi-terminal-fill me-2 text-success"></i>Gerador de Comandos</h5>
    {{#if activeConfigName}}
    <span class="badge bg-dark-subtle text-light border border-secondary px-2 py-1 fw-normal" style="font-size: 0.8rem;">
      <i class="bi bi-file-earmark-check me-1 text-success"></i>{{activeConfigName}}
    </span>
    {{/if}}
  </div>
  <div class="flex-grow-1 p-4 overflow-auto position-relative {{#if isApplying}}pe-none opacity-50{{/if}}" style="transition: opacity 0.3s ease;">
    <div class="mb-4">
      <label class="form-label fw-bold h6">Broker</label>
      <select id="broker-select" class="form-select form-select-lg shadow-sm" aria-label="Default select example" {{#if isApplying}}disabled{{/if}}>
        <option selected disabled>Selecione um broker</option>
        {{#each brokers}}
        <option value="{{json this}}" {{#if (eq (json this) ../selectedBrokerJson)}}selected{{/if}}>{{title}}</option>
        {{/each}}
      </select>
    </div>

    <div id="topics-container" class="mb-4" style="display: {{#if showTopics}}block{{else}}none{{/if}}">
      <label class="form-label fw-bold h6">Tópicos de Inscrição</label>
      <select id="topics-select" class="form-select shadow-sm" multiple aria-label="Multiple select example" style="height: 200px;" {{#if isApplying}}disabled{{/if}}>
        {{#each topicosInscricao}}
        <option value="{{this}}" {{#if (contains ../selectedTopics this)}}selected{{/if}}>{{this}}</option>
        {{/each}}
      </select>
      <small class="text-muted mt-2 d-block"><i>Segure <kbd>Ctrl/Cmd</kbd> para seleção múltipla</i></small>
    </div>

    <div id="output-container" class="mt-4 animate__animated animate__fadeIn" style="display: {{#if mqttCmd}}block{{else}}none{{/if}};">
      <hr class="mb-4">
      
      <div class="mb-4">
        <label class="form-label fw-bold text-primary mb-2 small uppercase tracking-wider">Broker Address</label>
        <div id="broker-addr-editor" class="shadow-lg rounded overflow-hidden border border-primary-subtle"></div>
      </div>

      <div class="mb-3">
        <div class="d-flex justify-content-between align-items-center mb-2">
          <label class="form-label fw-bold text-success mb-0 small uppercase tracking-wider">Comando Final (CMD)</label>
          <button class="btn btn-sm btn-outline-success copy-btn shadow-sm" data-text="{{mqttCmd}}" {{#if isApplying}}disabled{{/if}}>
            <i class="bi bi-clipboard"></i> Copiar
          </button>
        </div>
        <div id="mqtt-cmd-editor" class="shadow-lg rounded overflow-hidden border border-success-subtle"></div>
      </div>
    </div>
  </div>
</div>
