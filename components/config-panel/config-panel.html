
<!-- COMPONENT HEADER -->
<div class="p-3 bg-dark text-primary-heading border-bottom shadow-sm">
  <h5 class="mb-0"><i class="bi bi-gear-fill me-2 text-primary"></i>Configuração JSON</h5>
</div>

<!-- REMOTE CONFIGURATION (URL LOADER) -->
<div class="mb-0">
  <div class="input-group p-3 border-bottom border-secondary-subtle">
    <input type="text" id="config-url" class="form-control border-secondary {{#if isUrlDirty}}is-invalid{{/if}}" 
           placeholder="URL do config.json" value="{{configUrl}}">
    <button id="load-url" class="btn btn-outline-primary" type="button">
      <i class="bi bi-download"></i>
    </button>
    {{#if isUrlDirty}}
    <div class="invalid-feedback order-last mt-2">
      A configuração no editor foi modificada e não condiz mais com esta URL.
    </div>
    {{/if}}
  </div>
</div>

<!-- SESSION HISTORY -->
<div class="px-3 py-2 border-bottom border-secondary-subtle">
  <div class="dropdown">
    <button class="btn btn-sm btn-outline-secondary dropdown-toggle border-0" type="button" data-bs-toggle="dropdown" aria-expanded="false">
      <i class="bi bi-clock-history me-1 text-info"></i> Histórico
    </button>
    <ul class="dropdown-menu shadow-lg border-secondary">
      {{#if history}}
        {{#each history}}
        <li><a class="dropdown-item history-item py-2" href="#" data-index="{{@index}}">
          <div class="d-flex justify-content-between align-items-center">
            <span class="small">{{name}}</span>
          </div>
        </a></li>
        {{/each}}
        <li><hr class="dropdown-divider border-secondary"></li>
        <li><a class="dropdown-item text-danger small" href="#" id="clear-history">
          <i class="bi bi-trash me-1"></i> Limpar Histórico
        </a></li>
      {{else}}
        <li><span class="dropdown-item disabled small">Nenhum histórico salvo</span></li>
      {{/if}}
    </ul>
  </div>
</div>

<!-- JSON EDITOR & ACTIONS -->
<div class="flex-grow-1 px-0 pb-3 overflow-hidden d-flex flex-column" id="editor-wrapper">
  <div id="json-editor" class="flex-grow-1 shadow-sm border-bottom border-secondary-subtle" style="min-height: 0;"></div>
  <div class="px-3 mt-3">
    <button id="apply-config" class="btn btn-primary w-100 shadow-sm fw-bold py-2" 
            {{#if isApplying}}disabled{{/if}} {{#unless isConfigDirty}}disabled{{/unless}}>
      <i class="bi bi-arrow-repeat me-2 {{#if isApplying}}spin-icon{{/if}}"></i>
      {{#if isApplying}}Aplicando...{{else}}Aplicar e Atualizar{{/if}}
    </button>
  </div>
  <style>
    .spin-icon {
      display: inline-block;
      animation: spin 1s linear infinite;
    }
    @keyframes spin {
      0% { transform: rotate(0deg); }
      100% { transform: rotate(360deg); }
    }
    .text-primary-heading { color: #0d6efd !important; }
  </style>
</div>
